module "tableau_server" {
  source                      = "git::ssh://git@github.com/osodevops/aws-terraform-module-tableau.git//modules/tableau-cluster"
  alb_allowed_ips             = var.alb_allowed_ips
  deployment                  = var.deployment
  instance_allowed_ips        = var.instance_allowed_ips
  common_tags                 = var.common_tags
  environment                 = var.environment
  ssh_key_name                = var.ssh_key_name
  alb_certificate_arn         = var.alb_certificate_arn
  alb_deletion_protection     = var.alb_deletion_protection
  force_destroy               = var.force_destroy
  asg_force_delete            = var.asg_force_delete
  vpc_name                    = var.vpc_name
  alb_internal                = var.alb_internal
  aws_region                  = var.aws_region
  account_alias               = var.account_alias
  dns_zone                    = var.dns_zone
  dns_name                    = var.deployment
  is_private_zone             = var.is_private_zone
  enable_lambdas              = var.enable_lambdas
  create_lambdas              = var.create_lambdas
  maximum_zookeeper_size      = var.maximum_zookeeper_size
  manage_zookeeper            = var.manage_zookeeper
  manage_new_nodes            = var.manage_new_nodes
  manage_terminations         = var.manage_terminations
  manage_replicas             = var.manage_replicas
  lambda_execution_schedule   = var.lambda_execution_schedule
  enable_sf_build_automation  = var.enable_sf_build_automation
  sf_build_timer_schedule     = var.sf_build_timer_schedule
  enable_sf_recovery_automation = var.enable_sf_recovery_automation
  sf_recovery_timer_schedule = var.sf_recovery_timer_schedule
  frontend_domain             = var.frontend_domain
  alb_tags                    = var.alb_tags
  ami_name                    = var.ami_name
  cluster_definition          = jsondecode(file("${path.module}/cluster_definition.json"))
  use_external_database       = var.use_external_database
  rds_instance_class          = var.rds_instance_class
  rds_allocated_storage       = var.rds_allocated_storage
  rds_max_allocated_storage   = var.rds_max_allocated_storage
  rds_storage_encrypted       = var.rds_storage_encrypted
  rds_db_name                 = var.rds_db_name
  rds_multi_az                = var.rds_multi_az
  rds_maintenance_window      = var.rds_maintenance_window
  rds_backup_window           = var.rds_backup_window
  rds_backup_retention_period = var.rds_backup_retention_period
  rds_skip_final_snapshot     = var.rds_skip_final_snapshot
  rds_deletion_protection     = var.rds_deletion_protection
  rds_create_monitoring_role  = var.rds_create_monitoring_role
  rds_monitoring_role_name    = var.rds_monitoring_role_name
  rds_performance_insights_enabled          = var.rds_performance_insights_enabled
  rds_performance_insights_retention_period = var.rds_performance_insights_retention_period
}
